# leeper-ai gitleaks config
# Extends built-in rules with PII detection
# Copy this into each project repo alongside .pre-commit-config.yaml

title = "leeper-ai gitleaks config"

# -- Custom PII rules --

[[rules]]
id = "ssn"
description = "Social Security Number"
regex = '''\b\d{3}-\d{2}-\d{4}\b'''
keywords = ["ssn", "social"]

[[rules]]
id = "us-phone"
description = "US phone number"
regex = '''\b(\+?1[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b'''
keywords = ["phone", "tel", "mobile", "cell"]

[[rules]]
id = "email-in-code"
description = "Email address in source code"
regex = '''\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}\b'''
paths = ['\.py$', '\.ts$', '\.js$', '\.tsx$', '\.jsx$']

[[rules]]
id = "hardcoded-ip"
description = "Hardcoded IP address"
regex = '''\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'''
paths = ['\.py$', '\.ts$', '\.js$', '\.yaml$', '\.yml$', '\.toml$']

[[rules]]
id = "db-connection-string"
description = "Database connection string with credentials"
regex = '''(?i)(postgres|mysql|mongodb|redis):\/\/[^:]+:[^@]+@'''

# -- Allow-list (false positive suppression) --

[allowlist]
description = "Safe patterns"
paths = [
  '''tests?/''',
  '''fixtures?/''',
  '''mock/''',
  '''__mocks__/''',
]
regexes = [
  '''example\.com''',
  '''test@test''',
  '''000-00-0000''',
  '''555-\d{4}''',
  '''123-45-6789''',
  '''user@example''',
  '''placeholder''',
  '''xxx-xx-xxxx''',
  '''127\.0\.0\.1''',
  '''0\.0\.0\.0''',
  '''10\.\d{1,3}\.\d{1,3}\.\d{1,3}''',
  '''172\.(1[6-9]|2\d|3[01])\.\d{1,3}\.\d{1,3}''',
  '''192\.168\.\d{1,3}\.\d{1,3}''',
]
